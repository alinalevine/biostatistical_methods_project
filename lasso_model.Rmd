---
title: "lasso_model"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(glmnet)
```

```{r load_data}
cancer_data = read.csv(file = "data/Cancer_Registry.csv")
```

missing data:

PctSomeCol18_24

PctOtherRace

PctEmployed16_Over

studyPerCap

PctPrivateCoverageAlone

binnedInc

```{r inspect_data}
cancer_data = cancer_data %>%
  select(-PctSomeCol18_24, -PctOtherRace, -PctEmployed16_Over, -studyPerCap,
         -PctPrivateCoverageAlone, -binnedInc, -Geography)

round(cor(cancer_data),3)
```

collinearity:

avgAnnCount avgDeathsPerYear popEst2015

medIncome povertyPercent PctPrivateCoverage PctEmpPrivCoverage PctPublicCoverage PctPublicCoverageAlone

medIncome PctBachDeg25_Over

MedianAgeMale MedianAgeFemale

PercentMarried PctMarriedHouseholds

PctHS25_Over PctBachDeg25_Over

PctWhite PctBlack

```{r lasso, fig.width=10, fig.height=10}
cancer_x = cancer_data %>%
  select(-TARGET_deathRate)

predictor = as.matrix(cancer_x)

target = as.matrix(cancer_data$TARGET_deathRate)

grid <- 10^seq(2,-2, length=10)

lasso <- cv.glmnet(predictor, target, standardize = TRUE)

plot(lasso$glmnet.fit, "lambda", label=TRUE)

str(cancer_x)
colnames(cancer_x)
```

16, 21, 3, 6, 15, 17, 13, 25, 18, 23

PctBachDeg25_Over, PctPublicCoverageAlone, incidenceRate, povertyPercent,
PctHS25_Over, PctUnemployed16_Over, PctHS18_24, PctMarriedHouseholds,
PctPrivateCoverage, PctBlack

```{r linear}
fit_1 = lm(TARGET_deathRate ~ PctBachDeg25_Over + PctPublicCoverageAlone + incidenceRate + povertyPercent + PctHS25_Over + PctUnemployed16_Over + PctHS18_24 + PctMarriedHouseholds + PctPrivateCoverage + PctBlack, data = cancer_data)

summary(fit_1)

fit_2 = lm(TARGET_deathRate ~ PctBachDeg25_Over + incidenceRate + povertyPercent + PctHS25_Over + PctUnemployed16_Over + PctHS18_24 + PctMarriedHouseholds + PctPrivateCoverage + PctBlack, data = cancer_data)

summary(fit_2)

fit_3 = lm(TARGET_deathRate ~ PctBachDeg25_Over + incidenceRate + povertyPercent + PctHS25_Over + PctUnemployed16_Over + PctHS18_24 + PctMarriedHouseholds + PctPrivateCoverage, data = cancer_data)

summary(fit_3)
```

